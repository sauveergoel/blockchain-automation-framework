apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: storesgstoresgibft
  namespace: storesg-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: storesgstoresgibft
  chart:
    git: ssh://git@github.com/sauveergoel/blockchain-automation-framework.git
    ref: besuupgrade
    path: platforms/hyperledger-besu/charts/node_orion 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://d34682fefc1416504b59221ba0bf74506a61f442663b2bfbda1b4cce8f1b850efacdd5c7758664ef68e57f75e333ba64c418dee52d2bb5a4a127848017bf0b37@54.73.71.70:15050"
      - "enode://ec9c4be8723994ba67c711dcf1b8fd009ac3e7bf72854351b096e542f4fafdb73a4c7e8f49ca0b04143b8c500e1851131a2e1d2b21b06b6b9c854cc62ab89276@54.73.71.70:15060"
      - "enode://3bf8bdc0351aa7efeb47916de7b4eea33e7d0dcccc9038da927f4ccd4ca86c09a94fbf03d4af0512cdb3d031a63bdd705c4fbbf63a12ddfa7889d030fafc61be@54.73.71.70:15070"
      - "enode://59e67b1123f55c61164ff344c6e4ea67596d3ef863cbc29eb2e76ecca449629a43741dffb3b9e4af3030c6bed888ecf2c5cd1a5c03fbf4f89746cc8dcb58b362@54.73.71.70:15080"
      - "enode://bb32f5404d0792a9fad666216e26fbfa66adab7acadb97066b39ad45010e048d279d556adb03c38299192e84dfc6be4d536d2eb343255bb5d659e34740bf40f6@54.73.71.70:15010"
      - "enode://3f2ad3e8c5f05942ccfcd0732a5e5bc13c75180a6ce902152c270f4ccfe60393f8677193ed2e3602529cae7d5b51938df2d542807168fc3d435c981b7d4e8049@54.73.71.70:15020"
      - "enode://9af7b3343f62a2f3fd909e58d172eb4b8230cc23b074fad614d1c9c22119bfda371f3a268dc87aea92a51c95995b4dca551c08e4d05b331589e22a6c9c7c5542@54.73.71.70:15030"
      - "enode://b5447036fba6a1f79c54d8fe3073d9773e601d340e1106c5c70b123d960cd0d3c5221a5b2287fbc666a6717eaadd19a6a69a2e96340e5c6964bd9dae184e6a4a@54.73.71.70:15040"

    metadata:
      namespace: storesg-bes
      labels:

    liveliness_check:
      enabled: false

    proxy:
      provider: ambassador
      external_url: storesg.besu.devh3.aws.blockchaincloudpoc-develop.com
      p2p: 15030
      rpc: 15031
      tmport: 15033

    images:
      node: hyperledger/besu:1.5.3
      alpineutils: hyperledgerlabs/alpine-utils:1.0
      orion: pegasyseng/orion:1.6.0

    node:
      name: storesg
      consensus: ibft
      subject: O=Store,OU=Store,L=New York,C=US
      mountPath: /etc/genesis
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    orion:
      name: orion
      tls: True
      confdir: /etc/config
      url: "https://storesg.besu.devh3.aws.blockchaincloudpoc-develop.com"
      nodelist: "\"https://carriersg.besu.devh3.aws.blockchaincloudpoc-develop.com:15013\",\"https://manufacturersg.besu.devh3.aws.blockchaincloudpoc-develop.com:15023\",\"https://warehousesg.besu.devh3.aws.blockchaincloudpoc-develop.com:15043\""
      trust: ca-or-tofu
      ports:
        nodeport: 8888
        clientport: 8080

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://ab0e697583dfc447b8d14e6526e14759-1481581572.eu-west-1.elb.amazonaws.com:20002
      secretprefix: secret/storesg-bes/crypto/storesg
      serviceaccountname: vault-auth
      keyname: data
      oriondir: orion
      tlsdir: tls
      role: vault-role
      authpath: besustoresg

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NGY3OTZiNTk5ZjI0MzQ4MjljNjA1Njk4NGNiMDkzZTczZTIxNTZmYTM5NGRlYWY3MTQzYmExNzk0ODk1Y2E5MzA5MWQwMjg2ODk0NGUzYjM5ODM5NDAzZmZkZDA3OGFlMjJkMjYzNmUyMTI1YjE3MGNhOTI1MDg5ZTYzZjM5NDQyOTJlODBiNTdjMDk0ZDhjY2UwNjc3ZDAxNzJiYTNjYTE2Mzg3MzY4MDg0MDAwMDAwMDBjMCIKfQ==
