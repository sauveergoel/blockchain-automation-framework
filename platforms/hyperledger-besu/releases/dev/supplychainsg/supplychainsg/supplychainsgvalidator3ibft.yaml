apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: supplychainsgvalidator3ibft
  namespace: supplychainsg-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychainsgvalidator3ibft
  chart:
    git: ssh://git@github.com/sauveergoel/blockchain-automation-framework.git
    ref: besuupgrade
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://eb3c264aaf118e6eef4f3dbb22fe4612228887644be7cbb6bcad4f5aea1f22d1f10065dab55a1719210844e05be62fb2336abfcce092be15624fc1711ea536a0@54.73.71.70:15050"
      - "enode://daf9887b61c096495d56fa8034d8e41497d453dd376a2ebdbad9a364fcca86f5c62de1b0a192cef7af7ed7d75bd0874486513d9eed110a92f543fbc348ff35e3@54.73.71.70:15060"
      - "enode://fa5db7ad9d08b24ebe00d76cfd45d72e23a8f4e37b8bd43f0c1cbff8ea5e91766355f5e66b4bdf99bfc4d9d63a6907685a438edfe540015a282ec89bae8af033@54.73.71.70:15070"
      - "enode://47ccfc9a142f1965177b13e450db09fa15a2a0bcc74b5899b49c5efb306e0bd3f6901a1d138917d683546c8c62aa7dee5345119308544fc8beee11d3b4fa5f0b@54.73.71.70:15080"
      - "enode://29b027cb071c4e1b73f6d0c1f16e5822137548d215928722a934d487a2bfbc4a3899d03fba143c4bff119000506b0632e3fa298f48712c764d87cfed6352ea68@54.73.71.70:15010"
      - "enode://2e9f7f76237c3bc356ed6ec491d7987836bce4a263fd1bcd6bb5ca0eeaf2450513f42fd1a5975a3df8aee4e68318cd1a395dca9577d5cc7cc66cd47f3b798bb6@54.73.71.70:15020"
      - "enode://88108f52e27ba3b32bd823099acddf2ea0d7492bf980fd397cc4648fa32e9adb986e3b500361d064cfd48b54c406650fba6c2675fe36ce4f4019465d33a49149@54.73.71.70:15030"
      - "enode://8785fd18fc3b1fae198b847a5b19b7b9bb22f73c2635317dadb0eb2c0c18a71bb1edc81fb78a77b885edd5e68d385afa7c299947301e71833f1aef0069842dd0@54.73.71.70:15040"

    metadata:
      namespace: supplychainsg-bes
      labels:

    ambassador:
      external_url_suffix: besu.devh3.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false

    proxy:
      provider: ambassador
      external_url: supplychainsg.besu.devh3.aws.blockchaincloudpoc-develop.com
      p2p: 15070
      rpc: 15071

    images:
      node: hyperledger/besu:1.5.3
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator3
      tls: True
      consensus: ibft
      mountPath: /etc/genesis
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://ab0e697583dfc447b8d14e6526e14759-1481581572.eu-west-1.elb.amazonaws.com:20002
      secretprefix: secret/supplychainsg-bes/crypto/validator3
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychainsg

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NDNhOWMyNGYxMGQ4NDE5ZDZhOGM5NzMwYzIzNDIzNDViOThlMGI1NDc5NDAxYTVlNDE5Yzc5NTczOWIzZGExOWE3NTRmMDkyYmE4YzJkNTY5Nzc5NGVhZThjMDc5Zjc5YzRmZjZhZjk4MGFjNGI4YTFmZGUyZWM0NTJiNmQ5NDZjYjkxNjc3MDcwYzM5Nzg3MzUxYjJlMzMwMzI5NmEwMTdmYTYwMDg4MDg0MDAwMDAwMDBjMCIKfQ==
