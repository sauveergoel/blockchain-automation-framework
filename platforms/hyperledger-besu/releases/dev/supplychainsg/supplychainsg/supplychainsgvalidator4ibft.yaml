apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: supplychainsgvalidator4ibft
  namespace: supplychainsg-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychainsgvalidator4ibft
  chart:
    git: ssh://git@github.com/sauveergoel/blockchain-automation-framework.git
    ref: besuupgrade
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://fdc735e819ba76a12e2baf6d5eff551380ff98bd8788ec425abae7887551039cbe1521f5846c0d1088c9c7df53be233a2797807725848fdf0b8efa3117b0fd56@54.73.71.70:15150"
      - "enode://38c5d0f67a670f6013c03a1e96f97aab0060d374a60d434d6f7f0db1eb53da1b020f9f6237e487c81d7e527c6deaae489837844270e96fa924d8761601822c76@54.73.71.70:15160"
      - "enode://b1e61944fb1eed00b53b57f0ae3e6c389b98957c9867ec9309574b9f69857f7bfda94e832d1392d728603c82735679ca714c84c5fb44d9fb22b2d7a8bf60b933@54.73.71.70:15170"
      - "enode://8ccf5035eb91aa3d8a34d64100eebe4be622895b75485af37513ccd13dbd1dd636681afa6adc400496a92915fc385f68b3e079e579181cae666256c431b8738b@54.73.71.70:15180"
      - "enode://d69a94189d61146b2e15b674344a0df8ecccd46e43d330e5934e965cd40cefc5fe76d41618d656a8b1f58cb9e6723dcab7a3478c9833ae04319fb2e47648a7d1@54.73.71.70:15110"
      - "enode://897c09487f0d394db262f1e5cccac87dc97e9be4e1b3c40dd4911e0728bf70d1e6235414bf6c10e3321bab48b2013e780deadab9d6f385021e3744ed2dcefaf1@54.73.71.70:15120"
      - "enode://c5fc95d33e24a10bcf31446581fba6655d6e80c69c424c69698ba20d5f6fc02c911df69b6e85f54c4bf374fd361ba595f024dab6373c5bdff4e9913555b07835@54.73.71.70:15130"
      - "enode://add5add289a13291b8573f1ccb6d167fa0c8606223ec43e33c08ffebe43a874468773e72ba31aa3800463a7b9a42ad07fa5eefb327144bbb0f34ee307d248e5d@54.73.71.70:15140"

    metadata:
      namespace: supplychainsg-bes
      labels:

    ambassador:
      external_url_suffix: besu.devh3.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false

    proxy:
      provider: ambassador
      external_url: supplychainsg.besu.devh3.aws.blockchaincloudpoc-develop.com
      p2p: 15180
      rpc: 15181

    images:
      node: hyperledger/besu:1.5.3
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator4
      tls: True
      consensus: ibft
      mountPath: /etc/genesis
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://ab0e697583dfc447b8d14e6526e14759-1481581572.eu-west-1.elb.amazonaws.com:20002
      secretprefix: secret/supplychainsg-bes/crypto/validator4
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychainsg

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NDY1OWM2Y2MwZDJkZTMzNDc3MmFmNTU1MTA1NWIxNGNjM2MwNzdiOGQ5NDUzMzE2YTI0MDI2YTFhN2Y4Nzk5ZDlhNTAyOTQ1MDdlOTAwNTAwNzM5NDkwNDdmOTYxMjY4YmFmYzViZTNkNmQxNmEwNTRhM2NjYTkyYjAyOWU5NDRlZmM5YTNlNWRhMTExMDk2MTM5NzBlNGM3ZDcxYzFkZGFkYjQ5ZGU4MDg0MDAwMDAwMDBjMCIKfQ==
