apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: supplychainlvalidator4ibft
  namespace: supplychainl-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychainlvalidator4ibft
  chart:
    git: ssh://git@github.com/sauveergoel/blockchain-automation-framework.git
    ref: besuupgrade
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://397f30976f1762f9235833b78cee29149e78d82ccd70cdc79908a7551e68dcff9d5cdb402d99025fb44c1ad44503f57ae43e82023c8840a5f26d24afe2208996@54.73.71.70:15050"
      - "enode://6876002594311549af95b25349bc3674fc0249eeb85af3d8ca8a641dbe76fae90bda6bdf529fc71e47a50cfa3c57f2e84dd9390f9605aea1e6dc9de2c26706eb@54.73.71.70:15060"
      - "enode://2e2f9d70f64e82291e67ee298fc92b875e67d3d676f5a31c85cc25589c614bb48cd2294ced5df28e5752b2388e69fd20ac095c6b168c1c2a6c7c347845d6b1cd@54.73.71.70:15070"
      - "enode://b2e76dcfdef3730eda510abebe51b412899c5e995b4433eb3fee780549e319b059ba44036e83d8c8a3a1d9eacef9545cf9d950ede43373ccae8449d29d3d9444@54.73.71.70:15080"
      - "enode://740603a6bb1a860a5381da1befe8c8ae1e1e22dc4151e420e90db3fa4532d925d7146ef3a5fae0851827064506e5c39990ea3c2f3cb1eb1bc994440dbb8e8461@54.73.71.70:15010"
      - "enode://8e60c4ed0af5965724f0620c31d132cdfd150574093b63128b7aa21688f58d79b4714aa1cd4b1b801eec3eedb06de0254f0d79bfc7e4e63cda4390fcb5745435@54.73.71.70:15020"
      - "enode://e129f966e831b94f5837435a098636b86db7055b71f7e06493a257b6158e1d8807d00999e41fd44dab4f4bcf3aadc1a2de599c1f03e27245dc8235bd85705c58@54.73.71.70:15030"
      - "enode://dccfa58192676b0ef03c08bae88666e4bfc8fc15057aceb4d860ff8b55da9e4eb43b786bf5c163e546089619c75f2e128c2362160c560a193d7d2f7d9d73964c@54.73.71.70:15040"

    metadata:
      namespace: supplychainl-bes
      labels:

    ambassador:
      external_url_suffix: besu.devh3.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false

    proxy:
      provider: ambassador
      external_url: supplychainl.besu.devh3.aws.blockchaincloudpoc-develop.com
      p2p: 15080
      rpc: 15081

    images:
      node: hyperledger/besu:1.5.3
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator4
      tls: True
      consensus: ibft
      mountPath: /etc/genesis
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://ab0e697583dfc447b8d14e6526e14759-1481581572.eu-west-1.elb.amazonaws.com:20002
      secretprefix: secret/supplychainl-bes/crypto/validator4
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychainl

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NDU3NDJiOWYyZjFiZGRkZmEyYTI3ODRhY2U5OTEyMTA1Y2UxMDMzN2E5NGQwM2NkZGIzNjcwOTQxZjM0NGUxMjUwYWUyMDkwYzM2YmE1OGU2OGE5NDA3MjRlNmI4N2QyMDc2NDg5N2NmMjc5NTg5MTgxZDEzNDY4NDljNzg5NDhiMDI4MDM4Yzc1ZjY1MWE2MjEyZTY3NjdhNDI5ZDUwMDAyZDJhMjg4MDg0MDAwMDAwMDBjMCIKfQ==
